### Script speed tester for ServiceNow
- Use to measure time efficiency of your scripts
- Compare the running times of up to 9 scripts
- Adjust the amount of iterations per script
- Outputs the results to a HTML table
- Flow runs in the background evaluating an executing the scripts
---
#### Installing to your instance
- Fork the application and import it to Studio ([check the ServiceNow Developer page for instructions](https://developer.servicenow.com/dev.do#!/learn/learning-plans/washingtondc/new_to_servicenow/BNI_Lab_ForkRepo_washingtondc))
- OR install through the update set [`sn-script-speed-tester.xml`](https://github.com/nikalsson/sn-script-speed-tester/blob/main/sn-script-speed-tester.xml)
---
#### Screenshots

![Test Definition](https://github.com/nikalsson/sn-script-speed-tester/assets/41194476/07187e7c-18ac-4b3e-8695-8638067ac240)
![Test Result](https://github.com/nikalsson/sn-script-speed-tester/assets/41194476/467cb233-02ed-4d16-992e-2c6f03883ca7)

<style>    container {        text-align: left; /* Align all content left */    }    #results_table {        padding: 10px; /* Add padding to the table */        border-collapse: collapse; /* Collapse borders to ensure continuous lines */        margin: 0; /* Align the table to the left */        width: auto; /* Make the table width adjust to content */    }    #results_table th {        background-color: lightgrey; /* Light grey background for column headers */        font-weight: bold; /* Bold font weight for column headers */    }    #results_table th,    #results_table td {        border: 1px solid black; /* Add border with continuous black lines */        padding: 8px; /* Add padding to table cells */    }    .script {        background-color: #f4f4f4; /* Light grey background for code blocks */        padding: 10px; /* Add padding to code blocks */        border: 1px solid #ddd; /* Add border */        white-space: pre-wrap; /* Preserve white spaces and wrap lines */        overflow-x: auto; /* Enable horizontal scroll if needed */    }    .script_name {        font-weight: bold; /* Bold font weight for script names */    }</style><div id="results_summary">Test ran by <strong>System Administrator</strong> at 2024-05-27 08:38:35<br /><br />Fastest script is <strong>GR not in loop, better query</strong> with an average execution time of 33.64 milliseconds<br />Slowest script is <strong>GR in nested loop</strong> with an average execution time of 724.08 milliseconds<br /><br />Scripts in order from fastest to slowest. Iterations: 25. Times are in milliseconds.</div><table id="results_table"><thead><tr><th>Script</th><th>Script #</th><th>Average Time</th><th>Total Execution Time</th><th>Slower than Fastest, %</th><th>Execution Times</th></tr></thead><tbody><tr><td>GR not in loop, better query</td><td>3</td><td>33.64</td><td>841</td><td>0</td><td>31, 33, 34, 33, 34, 36, 36, 32, 34, 32, 34, 33, 32, 32, 33, 31, 34, 34, 33, 32, 37, 33, 40, 34, 34</td></tr><tr><td>GR not in loop, simple query</td><td>2</td><td>34.96</td><td>874</td><td>4</td><td>34, 34, 37, 34, 32, 40, 38, 36, 33, 34, 35, 35, 38, 36, 35, 35, 34, 34, 35, 33, 33, 34, 34, 36, 35</td></tr><tr><td>GR in nested loop</td><td>1</td><td>724.08</td><td>18102</td><td>2052</td><td>700, 712, 714, 755, 670, 826, 787, 687, 697, 655, 718, 763, 747, 722, 649, 722, 762, 768, 801, 668, 693, 732, 734, 714, 706</td></tr></tbody></table><br /><br /><div id="scripts">Scripts used:<pre class="script"><span class="script_name">GR not in loop, better query</span><br />success &#61; (function() {    try {        // Write your script between START and END, do not change anything else        // START        var users_who_are_not_callers &#61; [];        var callers &#61; [];		// Get all users, who are callers on incidents        var caller_incident_gr &#61; new GlideRecord(&#39;incident&#39;);        caller_incident_gr.addNotNullQuery(&#39;caller_id&#39;);        caller_incident_gr.query();        while (caller_incident_gr.next()) {            callers.push(caller_incident_gr.getValue(&#39;caller_id&#39;));        }		// Then get all the rest of the users        var user_gr &#61; new GlideRecord(&#39;sys_user&#39;);		user_gr.addQuery(&#39;sys_id&#39;, &#39;NOT IN&#39;, callers)        user_gr.query();        while (user_gr.next()) {            users_who_are_not_callers.push(user_gr.getUniqueValue());        }        gs.info(&#39;[GR not in loop, better query] users_who_are_not_callers amount: &#39; &#43; users_who_are_not_callers.length);        // END        return true;    } catch (ex) {        return false;    }})();</pre><br /><pre class="script"><span class="script_name">GR not in loop, simple query</span><br />success &#61; (function() {    try {        // Write your script between START and END, do not change anything else        // START		// Collect the users and callers of incidents in separate GRs        var users_who_are_not_callers &#61; [];        var users &#61; {};        var callers &#61; {};        var user_gr &#61; new GlideRecord(&#39;sys_user&#39;);        user_gr.query();        while (user_gr.next()) {            users[user_gr.getUniqueValue()] &#61; true;        }        var caller_incident_gr &#61; new GlideRecord(&#39;incident&#39;);        caller_incident_gr.addNotNullQuery(&#39;caller_id&#39;);        caller_incident_gr.query();        while (caller_incident_gr.next()) {            callers[caller_incident_gr.getValue(&#39;caller_id&#39;)] &#61; true;        }        // Loop through the users and check against the incidents        for (user in users) {            if (!callers.hasOwnProperty(user)) {                users_who_are_not_callers.push(user);            }        }        gs.info(&#39;[GR not in loop] users_who_are_not_callers amount: &#39; &#43; users_who_are_not_callers.length);        // END        return true;    } catch (ex) {        return false;    }})();</pre><br /><pre class="script"><span class="script_name">GR in nested loop</span><br />success &#61; (function() {    try {        // Write your script between START and END, do not change anything else        // START        var users_who_are_not_callers &#61; [];        // Query all users        var user_gr &#61; new GlideRecord(&#39;sys_user&#39;);        user_gr.query();        while (user_gr.next()) {            // For each user check if they&#39;ve opened an incident            var caller_incident_gr &#61; new GlideRecord(&#39;incident&#39;);            caller_incident_gr.addNotNullQuery(&#39;caller_id&#39;);            caller_incident_gr.addQuery(&#39;caller_id&#39;, user_gr.getUniqueValue());            caller_incident_gr.setLimit(1);            caller_incident_gr.query();            if (!caller_incident_gr.hasNext()) {                users_who_are_not_callers.push(user_gr.getUniqueValue());            }        }		gs.info(&#39;[GR in nested loop] users_who_are_not_callers amount: &#39; &#43; users_who_are_not_callers.length);        // END        return true;    } catch (ex) {        return false;    }})();</pre><br /></div>
